<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Socratic ‚Äî Learn by Discovering</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Playfair+Display:wght@600;700&display=swap" rel="stylesheet">
</head>
<body>
<div class="app-container">
    <!-- Header with Settings -->
    <nav class="top-nav">
        <div></div>
        <button class="settings-btn" id="settingsBtn" title="API Settings">
            ‚öôÔ∏è Settings
        </button>
    </nav>

    <!-- Hero / Landing -->
    <header class="hero">
        <div class="hero-inner">
            <div class="brand">
                <div class="brand-icon">œÉ</div>
                <h1 class="brand-name">Socratic</h1>
            </div>
            <p class="tagline">Learn by discovering, not by being told.</p>
            <p class="subtitle">An AI companion that never gives answers ‚Äî only the questions that lead you to them.</p>
        </div>
    </header>

    <!-- Stats Bar -->
    <section class="stats-bar" id="statsBar">
        <div class="stat-item">
            <span class="stat-value" id="statSessions">0</span>
            <span class="stat-label">Sessions</span>
        </div>
        <div class="stat-item">
            <span class="stat-value" id="statExchanges">0</span>
            <span class="stat-label">Questions Explored</span>
        </div>
        <div class="stat-item">
            <span class="stat-value" id="statMinutes">0</span>
            <span class="stat-label">Minutes Learning</span>
        </div>
        <div class="stat-item">
            <span class="stat-value" id="statUnderstanding">0%</span>
            <span class="stat-label">Avg Understanding</span>
        </div>
    </section>

    <!-- Topic Input -->
    <section class="topic-section">
        <div class="topic-card">
            <h2>What do you want to understand?</h2>
            <p class="topic-hint">Enter any topic, concept, or question. Socratic will guide you to discover the answer yourself.</p>

            <form id="topicForm" class="topic-form">
                <div class="input-group">
                    <input type="text" id="topicInput" placeholder="e.g., How does photosynthesis work?" autocomplete="off" required>
                    <button type="submit" id="startBtn" class="btn-primary">
                        <span class="btn-text">Begin Discovery</span>
                        <span class="btn-loading" style="display:none;">
                            <span class="spinner"></span>
                        </span>
                    </button>
                </div>
                <div class="context-toggle">
                    <button type="button" id="contextToggle" class="btn-ghost">+ Add context about what you already know</button>
                    <textarea id="contextInput" class="context-area" placeholder="e.g., I know the basics of biology but never understood the light reactions..." style="display:none;"></textarea>
                </div>
            </form>
        </div>
    </section>

    <!-- Topic Suggestions -->
    <section class="suggestions-section" id="suggestionsSection">
        <h3>Or explore something fascinating</h3>
        <div class="suggestions-grid" id="suggestionsGrid">
            <!-- Populated by JS -->
        </div>
        <button id="refreshSuggestions" class="btn-ghost btn-small">Refresh suggestions</button>
    </section>

    <!-- Recent Sessions -->
    <section class="recent-section" id="recentSection" style="display:none;">
        <h3>Continue Learning</h3>
        <div class="sessions-list" id="recentSessions">
            <!-- Populated by JS -->
        </div>
        <a href="history.html" class="btn-ghost btn-small">View all sessions ‚Üí</a>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <p>Socratic ‚Äî AI-powered active learning through guided discovery</p>
        <p class="footer-sub">Powered by Google Gemini | The Socratic Method, reimagined</p>
    </footer>
</div>

<!-- API Key Setup Modal (shown on first visit) -->
<div class="modal-overlay" id="setupModal" style="display:none;">
    <div class="modal setup-modal">
        <div class="brand" style="justify-content:center;margin-bottom:16px;">
            <div class="brand-icon" style="width:40px;height:40px;font-size:22px;">œÉ</div>
            <h2 style="font-size:1.4rem;color:var(--text-bright);">Welcome to Socratic</h2>
        </div>
        <p style="margin-bottom:4px;">Let's get you set up in 30 seconds.</p>

        <div class="setup-trust-badges">
            <div class="trust-badge"><span class="trust-icon">üîí</span><span>Stored <strong>only</strong> in your browser</span></div>
            <div class="trust-badge"><span class="trust-icon">üåê</span><span>Never sent to any server except Google</span></div>
            <div class="trust-badge"><span class="trust-icon">üí∏</span><span>Gemini API is <strong>free</strong> to use</span></div>
        </div>

        <form id="setupForm" style="margin-top:20px;">
            <div class="input-group">
                <input type="password" id="setupApiKeyInput" placeholder="Paste your Gemini API key here..." autocomplete="off" required>
                <button type="submit" id="setupSaveBtn" class="btn-primary">
                    <span class="btn-text">Save & Start</span>
                    <span class="btn-loading" style="display:none;"><span class="spinner"></span></span>
                </button>
            </div>
            <div style="margin-top:8px;text-align:left;">
                <label style="font-size:0.8rem;color:var(--text-muted);cursor:pointer;display:flex;align-items:center;gap:6px;">
                    <input type="checkbox" id="setupShowKey" style="accent-color:var(--accent-primary);"> Show key
                </label>
            </div>
            <p id="setupError" style="color:var(--danger);font-size:0.85rem;margin-top:12px;display:none;"></p>
        </form>

        <div class="setup-steps">
            <h3>How to get a free API key:</h3>
            <ol>
                <li>Go to <a href="https://aistudio.google.com/apikey" target="_blank" rel="noopener">aistudio.google.com/apikey</a></li>
                <li>Sign in with your Google account</li>
                <li>Click <strong>"Create API key"</strong></li>
                <li>Copy the key and paste it above</li>
            </ol>
        </div>

        <div class="setup-privacy">
            <h4>üõ°Ô∏è Privacy Promise</h4>
            <p>
                Your API key is stored <strong>only in your browser's localStorage</strong>.
                It is <strong>never uploaded, logged, or shared</strong>. Socratic runs entirely
                in your browser ‚Äî the only external call is directly to Google's Gemini API.
                You can delete the key at any time from Settings.
            </p>
        </div>
    </div>
</div>

<!-- Settings Modal -->
<div class="modal-overlay" id="settingsModal" style="display:none;">
    <div class="modal settings-modal">
        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:20px;">
            <h2 style="font-size:1.2rem;color:var(--text-bright);">‚öôÔ∏è API Settings</h2>
            <button id="closeSettings" class="btn-ghost btn-small">‚úï</button>
        </div>

        <form id="settingsForm">
            <div class="settings-group">
                <label class="settings-label">Gemini API Key</label>
                <div class="input-group">
                    <input type="password" id="settingsApiKey" placeholder="Your Gemini API key" autocomplete="off">
                    <button type="button" id="settingsToggleKey" class="btn-ghost btn-small">Show</button>
                </div>
                <p class="settings-hint">Get a free key at <a href="https://aistudio.google.com/apikey" target="_blank">aistudio.google.com/apikey</a></p>
            </div>

            <div class="settings-group">
                <label class="settings-label">Model</label>
                <select id="settingsModel" class="settings-select">
                    <option value="gemini-2.5-flash-lite">Gemini 2.5 Flash Lite (recommended)</option>
                    <option value="gemini-2.5-flash">Gemini 2.5 Flash</option>
                    <option value="gemini-2.0-flash-lite">Gemini 2.0 Flash Lite</option>
                    <option value="gemini-2.0-flash">Gemini 2.0 Flash</option>
                    <option value="gemini-2.5-pro">Gemini 2.5 Pro (slower, smarter)</option>
                </select>
                <p class="settings-hint">If rate-limited, the app will automatically try other models as fallback.</p>
            </div>

            <div class="settings-group">
                <label class="settings-label">Temperature: <span id="tempValue">0.7</span></label>
                <input type="range" id="settingsTemp" min="0" max="1" step="0.1" value="0.7" class="settings-range">
                <p class="settings-hint">Lower = more focused, Higher = more creative</p>
            </div>

            <div class="settings-actions">
                <button type="submit" class="btn-primary">Save Settings</button>
                <button type="button" id="clearDataBtn" class="btn-danger btn-small">Clear All Data</button>
            </div>

            <p id="settingsMsg" style="text-align:center;font-size:0.85rem;margin-top:12px;display:none;"></p>
        </form>
    </div>
</div>

<script src="js/storage.js"></script>
<script src="js/gemini-api.js"></script>
<script src="js/index.js"></script>
</body>
</html>
