<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Socratic ‚Äî Learning Session</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Playfair+Display:wght@600;700&display=swap" rel="stylesheet">
</head>
<body>
<div class="app-container session-page">
    <!-- Session Header -->
    <header class="session-header">
        <div class="session-header-left">
            <a href="index.html" class="back-link">‚Üê Back</a>
            <div class="session-topic">
                <div class="brand-icon-small">œÉ</div>
                <div>
                    <h1 id="sessionTopic">Loading...</h1>
                    <span class="session-meta" id="sessionMeta">Exchange 1 ¬∑ Foundational</span>
                </div>
            </div>
        </div>
        <div class="session-header-right">
            <div class="understanding-gauge" id="understandingGauge">
                <svg viewBox="0 0 36 36" class="gauge-svg">
                    <path class="gauge-bg" d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831" />
                    <path class="gauge-fill" id="gaugeFill" stroke-dasharray="0, 100" d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831" />
                    <text x="18" y="20.5" class="gauge-text" id="gaugeText">0%</text>
                </svg>
                <span class="gauge-label">Understanding</span>
            </div>
            <button id="endSessionBtn" class="btn-danger btn-small">End Session</button>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="difficulty-progress">
        <div class="difficulty-step completed" data-level="foundational">
            <span class="step-dot"></span>
            <span class="step-label">Foundational</span>
        </div>
        <div class="difficulty-step" data-level="intermediate">
            <span class="step-dot"></span>
            <span class="step-label">Intermediate</span>
        </div>
        <div class="difficulty-step" data-level="advanced">
            <span class="step-dot"></span>
            <span class="step-label">Advanced</span>
        </div>
        <div class="difficulty-step" data-level="mastery">
            <span class="step-dot"></span>
            <span class="step-label">Mastery</span>
        </div>
    </div>

    <!-- Conversation Area -->
    <main class="conversation-area" id="conversationArea">
        <!-- Messages populated by JS -->
    </main>

    <!-- Insights Panel (slides in) -->
    <aside class="insights-panel" id="insightsPanel">
        <button class="insights-toggle" id="insightsToggle" title="View Learning Insights">
            <span class="insights-icon">‚óà</span>
        </button>
        <div class="insights-content" id="insightsContent">
            <h3>Learning Insights</h3>
            <div class="insight-section">
                <h4>‚úì Correct Insights</h4>
                <ul id="correctInsights"><li class="empty">None yet ‚Äî keep exploring!</li></ul>
            </div>
            <div class="insight-section">
                <h4>‚úó Misconceptions Found</h4>
                <ul id="misconceptions"><li class="empty">None detected</li></ul>
            </div>
            <div class="insight-section">
                <h4>? Gaps to Explore</h4>
                <ul id="gaps"><li class="empty">Starting fresh</li></ul>
            </div>
        </div>
    </aside>

    <!-- Input Area -->
    <div class="input-area" id="inputArea">
        <div class="input-actions">
            <button id="hintBtn" class="btn-ghost btn-small hint-btn" title="Get a hint (won't give the answer)">
                üí° Hint
                <span class="hint-count" id="hintCount"></span>
            </button>
        </div>
        <form id="responseForm" class="response-form">
            <textarea id="responseInput" placeholder="Think carefully and share your reasoning..." rows="2" required></textarea>
            <button type="submit" id="submitBtn" class="btn-primary">
                <span class="btn-text">Send</span>
                <span class="btn-loading" style="display:none;">
                    <span class="spinner"></span>
                </span>
            </button>
        </form>
        <p class="input-tip">Tip: Explain your reasoning, not just the answer. Socratic values the <em>how</em> over the <em>what</em>.</p>
    </div>
</div>

<!-- End Session Modal -->
<div class="modal-overlay" id="endModal" style="display:none;">
    <div class="modal">
        <h2>End Learning Session?</h2>
        <p>Socratic will generate a comprehensive summary of what you discovered.</p>
        <div class="modal-actions">
            <button id="cancelEnd" class="btn-ghost">Keep Learning</button>
            <button id="confirmEnd" class="btn-primary">Generate Summary</button>
        </div>
    </div>
</div>

<script src="js/storage.js"></script>
<script src="js/gemini-api.js"></script>
<script src="js/session.js"></script>
</body>
</html>
